{"version":3,"sources":["index.ts"],"names":[],"mappings":"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","file":"src.37270ff2.map","sourceRoot":"../src","sourcesContent":["class Vec2D {\n\tx: number\n\ty: number\n\n\tconstructor(x = 0, y = 0) {\n\t\tthis.x = x\n\t\tthis.y = y\n\t}\n}\n\nclass Entity {\n\tposition: Vec2D\n\tvelocity: Vec2D\n\tmass: number\n\tradius: number\n\trestitution: number\n\n\tconstructor(x: number = 0, y:number = 0) {\n\t\tthis.position = new Vec2D(x, y)\n\t\tthis.velocity = new Vec2D(0, 0)\n\t\tthis.mass = 0.1\n\t\tthis.radius = 15\n\t\tthis.restitution = -0.7\n\t}\n}\n\nclass Wall {\n\tposition: Vec2D\n\tfrom: number\n\tto: number\n\ttype: string\n\tfriction: number\n\n\tconstructor(x: number = 0, y: number = 0, type = \"ground\") {\n\t\tthis.position = new Vec2D(x, y)\n\t\tthis.from = -1000\n\t\tthis.to = 1000\n\t\tthis.type = type\n\t\tthis.friction = 1.01\n\t}\n\n\trelative() {\n\t\tif (this.type === \"ground\") {\n\t\t\tlet x1 = this.position.x + this.from\n\t\t\tlet x2 = this.position.y + this.to\n\t\t\treturn {from: x1, to: x2}\n\t\t} else {\n\t\t\treturn {from: this.from, to: this.to}\n\t\t}\n\t}\n}\n\nfunction main() {\n\t// Constants\n\tconst FRAMERATE  = 1 / 60\n\tconst FRAMEDELAY = FRAMERATE * 1000\n\n\tconst Cd = 0.47\n\tconst rho = 1.22\n\n\t// TODO: Make A part of loop.\n\tconst radius = 15\n\tconst A = Math.PI * radius * radius / (10000) // m^2\n\n\tconst ag = 9.81\n\n\t// Setup\n\tconst canvas = <HTMLCanvasElement>document.getElementById(\"canvas\")\n\tvar ctx = canvas.getContext(\"2d\")\n\n\tvar entities: Entity[] = []\n\tvar walls: Wall[] = []\n\tentities.push(new Entity(canvas.width / 2, 0))\n\twalls.push(new Wall(canvas.height, canvas.width / 2))\n\n\tctx.fillStyle = 'red'\n\tctx.strokeStyle = 'black'\n\t// setInterval(loop, FRAMEDELAY)\n\twindow.addEventListener('keydown', handleInput,false);\n\tloop()\n\n\tfunction loop() {\n\t\tfor (let entity of entities) {\n\t\t\tgravityCalc(entity)\n\t\t\tscanCollisions(entity)\n\t\t\tctx.clearRect(0,0,canvas.width,canvas.height)\n\t\t\tdrawEntity(entity)\n\t\t\tsetInterval(() => {}, FRAMEDELAY)\n\t\t\tdrawWalls()\n\t\t}\n\t\trequestAnimationFrame(loop)\n\t}\n\n\tfunction gravityCalc(entity: Entity) {\n\t\tlet Fx = -0.5 * Cd * A * rho * entity.velocity.x * entity.velocity.x * entity.velocity.x / Math.abs(entity.velocity.x)\n\t\tlet Fy = -0.5 * Cd * A * rho * entity.velocity.y * entity.velocity.y * entity.velocity.y / Math.abs(entity.velocity.y)\n\t\t\n\t\tif (isNaN(Fx)) {\n\t\t\tFx = 0 \n\t\t}\n\n\t\tif (isNaN(Fy)){\n\t\t\tFy = 0\n\t\t}\n\n\t\tlet ax = Fx / entity.mass\n\t\tlet ay = ag + (Fy / entity.mass)\n\n\t\tentity.velocity.x += ax * FRAMERATE\n\t\tentity.velocity.y += ay * FRAMERATE\n\n\t\tentity.position.x += entity.velocity.x * FRAMERATE * 100 \n\t\tentity.position.y += entity.velocity.y * FRAMERATE * 100\n\t\treturn entity\n\t}\n\n\tfunction scanCollisions(entity: Entity) {\n\t\tfor (let wall of walls) {\n\t\t\tswitch (wall.type) {\n\t\t\t\tcase \"ground\":{\n\t\t\t\t\tif ((entity.position.y + entity.radius) > wall.position.y) {\n\t\t\t\t\t\tif (wall.relative().from < entity.position.x && entity.position.x  < wall.relative().to) {\n\t\t\t\t\t\t\tentity.velocity.y *= entity.restitution\n\t\t\t\t\t\t\t// entity.velocity.x -= entity.velocity.x / wall.friction\n\t\t\t\t\t\t\t// Temporary bad friction\n\t\t\t\t\t\t\t// TODO: Redo friction.\n\t\t\t\t\t\t\tentity.velocity.x /= wall.friction\n\t\t\t\t\t\t\tentity.position.y = (wall.position.y - entity.radius)\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tbreak\n\t\t\t\t}\n\t\t\t\tdefault:{\n\t\t\t\t\tbreak\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction drawEntity(entity: Entity) {\n\t\tctx.beginPath()\n\t\tctx.arc(entity.position.x, entity.position.y, entity.radius, 0, Math.PI * 2, true)\n\t\tctx.fill()\n\t\tctx.closePath()\n\t}\n\n\tfunction drawWalls() {\n\t\tfor (let wall of walls) {\n\t\t\tctx.beginPath()\n\t\t\tctx.moveTo(wall.relative().from, wall.position.y)\n\t\t\tctx.lineTo(wall.relative().to, wall.position.y)\n\t\t\tctx.stroke()\n\t\t}\n\t}\n\n\tfunction handleInput(event) {\n\t\tswitch (event.keyCode) {\n\t\t\t// Left\n\t\t\tcase 37: {\n\t\t\t\tentities[0].velocity.x -= 5\n\t\t\t\tbreak\n\t\t\t}\n\t\t\t// Up\n\t\t \tcase 38: {\n\t\t \t\tentities[0].velocity.y -= 5\n\t\t \t\tbreak\n\t\t \t}\n\t\t \t// Right\n\t\t \tcase 39: {\n\t\t \t\tentities[0].velocity.x += 5\n\t\t \t\tbreak\n\t\t \t}\n\t\t \t// Down\n\t\t \tcase 40: {\n\t\t \t\tentities[0].velocity.y += 5\n\t\t \t\tbreak\n\t\t \t}\n\t\t \tdefault:\n\t\t \t\tbreak\n\t\t }\n\n\t}\n}\n\nmain()"]}